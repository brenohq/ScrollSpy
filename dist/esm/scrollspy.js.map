{"version":3,"file":"scrollspy.js","sourceRoot":"","sources":["../../src/scrollspy.js"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2016, Globo.com (https://github.com/globocom)\n *\n * License: MIT\n */\n\nvar instance = null;\nvar bind = function(fn, me) {\n  return function() {\n    return fn.apply(me, arguments);\n  };\n};\n\nfunction ScrollSpy() {\n  if (instance) {\n    return instance;\n  } else {\n    instance = {\n      add: bind(this.addElement, this),\n      clean: bind(this.cleanItems, this),\n      getItems: bind(this.getItems, this),\n      debug: bind(this.debug, this)\n    };\n  }\n  this.onScroll = bind(this.onScroll, this);\n  this.onResize = bind(this.onResize, this);\n  this.itemsLen = 0;\n  this.items = [];\n  this.setDefaultVariables();\n\n  return instance;\n}\n\nScrollSpy.prototype.throttle = function(callback) {\n  var idle = true;\n  return function() {\n    if (idle) {\n      callback();\n      idle = false;\n      setTimeout(function() {\n        return (idle = true);\n      }, 150);\n    }\n  };\n};\n\nScrollSpy.prototype.cleanItems = function() {\n  this.items = [];\n};\n\nScrollSpy.prototype.startListener = function() {\n  window.addEventListener(\"scroll\", this.throttle(this.onScroll));\n  window.addEventListener(\"resize\", this.throttle(this.onResize));\n};\n\nScrollSpy.prototype.stopListeners = function() {\n  window.removeEventListener(\"scroll\", this.throttle(this.onScroll));\n  window.removeEventListener(\"resize\", this.throttle(this.onResize));\n};\n\nScrollSpy.prototype.resetElementPosition = function() {\n  var item;\n  this.winHeight = window.innerHeight;\n  for (var i = 0, len = this.items.length; i < len; i++) {\n    item = this.items[i];\n    item.pos = this.getElementPos(item);\n  }\n  this.checkVisibleItems();\n};\n\nScrollSpy.prototype.getElementPos = function(param) {\n  var top = this.getScrollY();\n  var boundClient = param.el.getBoundingClientRect();\n  return boundClient[param.reference] + top - param.offset;\n};\n\nScrollSpy.prototype.getScrollY = function() {\n  var doc;\n  if (typeof pageYOffset !== \"undefined\") {\n    return pageYOffset;\n  } else {\n    doc = document.documentElement;\n    doc = doc.clientHeight ? doc : document.body;\n    return doc.scrollTop;\n  }\n};\n\nScrollSpy.prototype.onResize = function() {\n  this.throttle(function() {\n    if (this.winHeight !== window.innerHeight) {\n      this.resetElementPosition();\n    }\n  });\n};\n\nScrollSpy.prototype.onScroll = function() {\n  this.checkDocumentHeight();\n  this.checkVisibleItems();\n};\n\nScrollSpy.prototype.getItems = function() {\n  return this.items;\n};\n\nScrollSpy.prototype.setDefaultVariables = function() {\n  this.winHeight = window.innerHeight;\n  this.lastPos = this.getScrollY();\n  this.docHeight = document.body ? document.body.offsetHeight : 0;\n};\n\nScrollSpy.prototype.addElement = function(param) {\n  var count, item, prevItensLength;\n  if (!param.el) {\n    return;\n  }\n  param.offset = typeof param.offset === \"undefined\" ? 200 : param.offset;\n  param.reference = param.reference || \"top\";\n  param.pos = this.getElementPos(param);\n  prevItensLength = this.items.length;\n  count = 0;\n\n  for (var i = 0, len = this.items.length; i < len; i++) {\n    item = this.items[i];\n    if (item.pos > param.pos) {\n      break;\n    }\n    count++;\n  }\n  this.items.splice(count, 0, param);\n  this.itemsLen = this.items.length;\n  if (prevItensLength === 0) {\n    this.setDefaultVariables();\n    this.startListener();\n  }\n  this.checkVisibleItems();\n};\n\nScrollSpy.prototype.checkDocumentHeight = function() {\n  var currentDocHeight = document.body.offsetHeight;\n  if (this.docHeight !== currentDocHeight) {\n    this.docHeight = currentDocHeight;\n    this.resetElementPosition();\n  }\n};\n\nScrollSpy.prototype.checkVisibleItems = function() {\n  var item;\n  var currentPos = this.getScrollY();\n  var currentPosOffset = this.winHeight + currentPos;\n  while (this.items.length) {\n    item = this.items[0];\n    if (currentPosOffset >= item.pos) {\n      if (item.callback) {\n        item.callback();\n      }\n      this.items.shift();\n      this.itemsLen = this.items.length;\n    } else {\n      break;\n    }\n  }\n  this.lastPos = currentPos;\n  if (!this.items.length) {\n    this.stopListeners();\n  }\n};\n\nScrollSpy.prototype.debug = function() {\n  var nodeHtml, css, border, color, item;\n\n  for (var i = 0, len = this.items.length; i < len; i++) {\n    item = this.items[i];\n    color = i % 2 ? \"red\" : \"blue\";\n    border = \"2px dashed \" + color;\n    item.el.style[\"border\"] = border;\n\n    css = \"top: \" + item.pos + \";\";\n    css += \"width: 100%;\";\n    css += \"position: absolute;\";\n    css += \"border-top: \" + border + \";\";\n\n    nodeHtml = document.createElement(\"div\");\n    nodeHtml.className = \"debug-line\";\n    nodeHtml.setAttribute(\"style\", css);\n    document.body.appendChild(nodeHtml);\n  }\n};\n\nexport default new ScrollSpy();\n"]}