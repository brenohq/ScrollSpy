!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).ScrollSpy=e()}(this,(function(){"use strict";var t=null,e=function(t,e){return function(){return t.apply(e,arguments)}};function i(){return t||(t={add:e(this.addElement,this),clean:e(this.cleanItems,this),getItems:e(this.getItems,this),debug:e(this.debug,this)},this.onScroll=e(this.onScroll,this),this.onResize=e(this.onResize,this),this.itemsLen=0,this.items=[],this.setDefaultVariables(),t)}return i.prototype.throttle=function(t){var e=!0;return function(){e&&(t(),e=!1,setTimeout((function(){return e=!0}),150))}},i.prototype.cleanItems=function(){this.items=[]},i.prototype.startListener=function(){window.addEventListener("scroll",this.throttle(this.onScroll)),window.addEventListener("resize",this.throttle(this.onResize))},i.prototype.stopListeners=function(){window.removeEventListener("scroll",this.throttle(this.onScroll)),window.removeEventListener("resize",this.throttle(this.onResize))},i.prototype.resetElementPosition=function(){var t;this.winHeight=window.innerHeight;for(var e=0,i=this.items.length;e<i;e++)(t=this.items[e]).pos=this.getElementPos(t);this.checkVisibleItems()},i.prototype.getElementPos=function(t){var e=this.getScrollY();return t.el.getBoundingClientRect()[t.reference]+e-t.offset},i.prototype.getScrollY=function(){var t;return"undefined"!=typeof pageYOffset?pageYOffset:(t=(t=document.documentElement).clientHeight?t:document.body).scrollTop},i.prototype.onResize=function(){this.throttle((function(){this.winHeight!==window.innerHeight&&this.resetElementPosition()}))},i.prototype.onScroll=function(){this.checkDocumentHeight(),this.checkVisibleItems()},i.prototype.getItems=function(){return this.items},i.prototype.setDefaultVariables=function(){this.winHeight=window.innerHeight,this.lastPos=this.getScrollY(),this.docHeight=document.body?document.body.offsetHeight:0},i.prototype.addElement=function(t){var e,i;if(t.el){t.offset=void 0===t.offset?200:t.offset,t.reference=t.reference||"top",t.pos=this.getElementPos(t),i=this.items.length,e=0;for(var s=0,o=this.items.length;s<o&&!(this.items[s].pos>t.pos);s++)e++;this.items.splice(e,0,t),this.itemsLen=this.items.length,0===i&&(this.setDefaultVariables(),this.startListener()),this.checkVisibleItems()}},i.prototype.checkDocumentHeight=function(){var t=document.body.offsetHeight;this.docHeight!==t&&(this.docHeight=t,this.resetElementPosition())},i.prototype.checkVisibleItems=function(){for(var t,e=this.getScrollY(),i=this.winHeight+e;this.items.length&&i>=(t=this.items[0]).pos;)t.callback&&t.callback(),this.items.shift(),this.itemsLen=this.items.length;this.lastPos=e,this.items.length||this.stopListeners()},i.prototype.debug=function(){for(var t,e,i,s,o=0,n=this.items.length;o<n;o++)i="2px dashed "+(o%2?"red":"blue"),(s=this.items[o]).el.style.border=i,e="top: "+s.pos+";",e+="width: 100%;",e+="position: absolute;",e+="border-top: "+i+";",(t=document.createElement("div")).className="debug-line",t.setAttribute("style",e),document.body.appendChild(t)},new i}));